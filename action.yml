name: 'mitmproxy-logger-action'
description: 'Automatically capture HTTP/HTTPS traffic with mitmproxy and upload as encrypted artifacts'
author: 'yaegashi'

inputs:
  enabled:
    description: 'Enable mitmproxy logging (true/false)'
    required: false
    default: 'true'
  listen-host:
    description: 'Proxy listen address'
    required: false
    default: '127.0.0.1'
  listen-port:
    description: 'Proxy listen port'
    required: false
    default: '8080'
  install-cacert:
    description: 'Install mitmproxy CA certificate to system trust store (true/false)'
    required: false
    default: 'true'
  set-envvars:
    description: 'Set proxy environment variables automatically (true/false)'
    required: false
    default: 'false'
  passphrase:
    description: 'Passphrase for artifact encryption'
    required: true
  artifact-name:
    description: 'Custom artifact name (optional, defaults to auto-generated name)'
    required: false
    default: ''

outputs:
  proxy-url:
    description: 'URL of the started proxy'
  stream-file:
    description: 'Path to the stream log file'
  cacert-path:
    description: 'Path to the CA certificate file'

runs:
  using: 'node20'
  pre: 'dist/pre/index.js'
  main: 'dist/main/index.js'
  post: 'dist/post/index.js'

branding:
  icon: 'globe'
  color: 'blue'